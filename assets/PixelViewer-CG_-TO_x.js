import{Q as Z}from"./Ripple-W4GDzb25.js";import{u as ee,a as te,b as ne,c as ae,d as le,e as ie,f as oe,Q as re,g as L}from"./use-file-dom-props-DsqXR_gX.js";import{g as Q,r as q,c as v,A as ue,C as X,t as se,h as F,k as Y,U as ce,z as de,d as fe,w as me,_ as ve,Q as W,J as M,P as D,L as ge,f as R,K,N as pe}from"./index-DHqvD7PT.js";import{h as he}from"./format-CJebrXOQ.js";import{u as be,a as ye}from"./use-dark-Y_7Q9Z3Q.js";import{h as U}from"./render-_96EmJ3L.js";import"./QSpinner-CYOdZbT0.js";import"./dom-BDeUsCDo.js";function z(e,n,g,h){const l=[];return e.forEach(i=>{h(i)===!0?l.push(i):n.push({failedPropValidation:g,file:i})}),l}function j(e){e?.dataTransfer&&(e.dataTransfer.dropEffect="copy"),X(e)}const xe={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Fe=["rejected"];function _e({editable:e,dnd:n,getFileInput:g,addFilesToQueue:h}){const{props:l,emit:i,proxy:s}=Q(),b=q(null),w=v(()=>l.accept!==void 0?l.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),c=v(()=>parseInt(l.maxFiles,10)),x=v(()=>parseInt(l.maxTotalSize,10));function d(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target?.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&ue(t);else{const _=g();_!==t.target&&_?.click(t)}}function f(t){e.value&&t&&h(null,t)}function k(t,_,I,N){let o=Array.from(_||t.target.files);const y=[],V=()=>{y.length!==0&&i("rejected",y)};if(l.accept!==void 0&&w.value.indexOf("*/")===-1&&(o=z(o,y,"accept",r=>w.value.some(m=>r.type.toUpperCase().startsWith(m)||r.name.toUpperCase().endsWith(m))),o.length===0))return V();if(l.maxFileSize!==void 0){const r=parseInt(l.maxFileSize,10);if(o=z(o,y,"max-file-size",m=>m.size<=r),o.length===0)return V()}if(l.multiple!==!0&&o.length!==0&&(o=[o[0]]),o.forEach(r=>{r.__key=r.webkitRelativePath+r.lastModified+r.name+r.size}),N===!0){const r=I.map(m=>m.__key);o=z(o,y,"duplicate",m=>r.includes(m.__key)===!1)}if(o.length===0)return V();if(l.maxTotalSize!==void 0){let r=N===!0?I.reduce((m,B)=>m+B.size,0):0;if(o=z(o,y,"max-total-size",m=>(r+=m.size,r<=x.value)),o.length===0)return V()}if(typeof l.filter=="function"){const r=l.filter(o);o=z(o,y,"filter",m=>r.includes(m))}if(l.maxFiles!==void 0){let r=N===!0?I.length:0;if(o=z(o,y,"max-files",()=>(r++,r<=c.value)),o.length===0)return V()}if(V(),o.length!==0)return o}function C(t){j(t),n.value!==!0&&(n.value=!0)}function u(t){X(t),(t.relatedTarget!==null||se.is.safari!==!0?t.relatedTarget!==b.value:document.elementsFromPoint(t.clientX,t.clientY).includes(b.value)===!1)===!0&&(n.value=!1)}function A(t){j(t);const _=t.dataTransfer.files;_.length!==0&&h(null,_),n.value=!1}function $(t){if(n.value===!0)return F("div",{ref:b,class:`q-${t}__dnd absolute-full`,onDragenter:j,onDragover:j,onDragleave:u,onDrop:A})}return Object.assign(s,{pickFiles:d,addFiles:f}),{pickFiles:d,addFiles:f,onDragover:C,onDragleave:u,processFiles:k,getDndNode:$,maxFilesNumber:c,maxTotalSizeNumber:x}}const Se=Y({name:"QFile",inheritAttrs:!1,props:{...ne,...te,...xe,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ee,...Fe],setup(e,{slots:n,emit:g,attrs:h}){const{proxy:l}=Q(),i=ae(),s=q(null),b=q(!1),w=le(e),{pickFiles:c,onDragover:x,onDragleave:d,processFiles:f,getDndNode:k}=_e({editable:i.editable,dnd:b,getFileInput:T,addFilesToQueue:E}),C=ie(e),u=v(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),A=v(()=>L(u.value)),$=v(()=>u.value.map(a=>a.name).join(", ")),t=v(()=>he(u.value.reduce((a,p)=>a+p.size,0))),_=v(()=>({totalSize:t.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),I=v(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:w.value,...h,id:i.targetUid.value,disabled:i.editable.value!==!0})),N=v(()=>"q-file q-field--auto-height"+(b.value===!0?" q-file--dnd":"")),o=v(()=>e.multiple===!0&&e.append===!0);function y(a){const p=u.value.slice();p.splice(a,1),r(p)}function V(a){const p=u.value.indexOf(a);p!==-1&&y(p)}function r(a){g("update:modelValue",e.multiple===!0?a:a[0])}function m(a){a.keyCode===13&&de(a)}function B(a){(a.keyCode===13||a.keyCode===32)&&c(a)}function T(){return s.value}function E(a,p){const S=f(a,p,u.value,o.value),O=T();O!=null&&(O.value=""),S!==void 0&&((e.multiple===!0?e.modelValue&&S.every(J=>u.value.includes(J)):e.modelValue===S[0])||r(o.value===!0?u.value.concat(S):S))}function P(){return[F("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function G(){if(n.file!==void 0)return u.value.length===0?P():u.value.map((p,S)=>n.file({index:S,file:p,ref:this}));if(n.selected!==void 0)return u.value.length===0?P():n.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?P():u.value.map((p,S)=>F(re,{key:"file-"+S,removable:i.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{y(S)}},()=>F("span",{class:"ellipsis",textContent:p.name})));const a=e.displayValue!==void 0?e.displayValue:$.value;return a.length!==0?[F("div",{class:e.inputClass,style:e.inputStyle,textContent:a})]:P()}function H(){const a={ref:s,...I.value,...C.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:E};return e.multiple===!0&&(a.multiple=!0),F("input",a)}return Object.assign(i,{fieldClass:N,emitValue:r,hasValue:A,inputRef:s,innerValue:u,floatingLabel:v(()=>A.value===!0||L(e.displayValue)),computedCounter:v(()=>{if(e.counterLabel!==void 0)return e.counterLabel(_.value);const a=e.maxFiles;return`${u.value.length}${a!==void 0?" / "+a:""} (${t.value})`}),getControlChild:()=>k("file"),getControl:()=>{const a={ref:i.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return i.editable.value===!0&&Object.assign(a,{onDragover:x,onDragleave:d,onKeydown:m,onKeyup:B}),F("div",a,[H()].concat(G()))}}),Object.assign(l,{removeAtIndex:y,removeFile:V,getNativeElement:()=>s.value}),ce(l,"nativeEl",()=>s.value),oe(i)}}),Ce=Y({name:"QBanner",props:{...be,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(e,{slots:n}){const{proxy:{$q:g}}=Q(),h=ye(e,g),l=v(()=>"q-banner row items-center"+(e.dense===!0?" q-banner--dense":"")+(h.value===!0?" q-banner--dark q-dark":"")+(e.rounded===!0?" rounded-borders":"")),i=v(()=>`q-banner__actions row items-center justify-end col-${e.inlineActions===!0?"auto":"all"}`);return()=>{const s=[F("div",{class:"q-banner__avatar col-auto row items-center self-start"},U(n.avatar)),F("div",{class:"q-banner__content col text-body2"},U(n.default))],b=U(n.action);return b!==void 0&&s.push(F("div",{class:i.value},b)),F("div",{class:l.value+(e.inlineActions===!1&&b!==void 0?" q-banner--top-padding":""),role:"alert"},s)}}}),Ve=fe({name:"PixelViewer",setup(){const e=q(null),n=q(null),g=q(null),h=q("Move your cursor over the image to see pixel information."),l=new Image;let i=null;function s(c){e.value=c}me(e,c=>{c&&(g.value=URL.createObjectURL(c),b())});function b(){l.onload=function(){n.value&&(i=n.value.getContext("2d"));const c=800,x=600;let d=l.width,f=l.height;d>c&&(f=f*(c/d),d=c),f>x&&(d=d*(x/f),f=x),n.value&&(n.value.width=d,n.value.height=f,i&&i.drawImage(l,0,0,d,f))},g.value&&(l.src=g.value)}function w(c){if(!i||!n.value)return;const x=n.value.getBoundingClientRect(),d=c.clientX-x.left,f=c.clientY-x.top;i.clearRect(0,0,n.value.width,n.value.height),i.drawImage(l,0,0,n.value.width,n.value.height);const k=i.getImageData(d,f,1,1).data;h.value=`x: ${d}, y: ${f}, RGB: (${k[0]}, ${k[1]}, ${k[2]})`;const C=10;i.strokeStyle="red",i.lineWidth=2,i.strokeRect(d-C/2,f-C/2,C,C)}return{model:e,canvas:n,urlmodel:g,message:h,event_cursor:w,event_file:s}}}),ke={class:"q-pa-md"},qe={class:"q-gutter-y-md column",style:{"max-width":"300px"}},we={key:0,class:"q-pa-md q-gutter-sm"},ze={style:{overflow:"auto","max-width":"100%","max-height":"600px"}},Ie={class:"q-pa-md q-gutter-sm"};function Ne(e,n,g,h,l,i){return M(),W("div",ke,[D("div",qe,[R(Se,{color:"grey-3",outlined:"","label-color":"orange",modelValue:e.model,"onUpdate:modelValue":[n[0]||(n[0]=s=>e.model=s),e.event_file],label:"Upload Image"},{append:K(()=>[R(Z,{name:"attachment",color:"orange"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),e.model?(M(),W("div",we,[D("div",ze,[D("canvas",{ref:"canvas",onMousemove:n[1]||(n[1]=(...s)=>e.event_cursor&&e.event_cursor(...s))},null,544)])])):ge("",!0),D("div",Ie,[R(Ce,{dense:"",class:"bg-primary text-white"},{default:K(()=>[D("h6",null,pe(e.message),1)]),_:1})])])}const Ue=ve(Ve,[["render",Ne]]);export{Ue as default};
