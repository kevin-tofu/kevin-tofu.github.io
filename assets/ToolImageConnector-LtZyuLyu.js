import{Q as F}from"./QFile-C4i9HaXa.js";import{E as P,r as h,w as Q,o as T,_ as W,N as p,G as f,M as o,I as L,L as c,J as V,K as z,z as G,a8 as H}from"./index-BhR0WcmR.js";import{u as J}from"./vue-i18n.runtime-dVZWppTj.js";import"./format-2CO7JL6p.js";import"./Ripple-tJgUjR42.js";import"./QSpinner-BUy009jF.js";import"./render-DQddtyOB.js";import"./dom-nElX5PBv.js";import"./use-dark-B6k9J0c7.js";import"./use-file-dom-props-Bgcd2o_i.js";const K=P({name:"ImageConnector",setup(){const{t:e,locale:t}=J(),a=h(null),n=h(null),R=h(null),k=h(null),l=h(null),b=h("rgb"),y=i=>new Promise((r,u)=>{const s=new Image;s.onload=()=>r(s),s.onerror=()=>u(new Error("Image load failed")),s.src=i}),j=i=>{i==="left"?(a.value&&URL.revokeObjectURL(a.value),a.value=null):(n.value&&URL.revokeObjectURL(n.value),n.value=null)},O=(i,r)=>{if(!r){j(i);return}i==="left"?(a.value&&URL.revokeObjectURL(a.value),a.value=URL.createObjectURL(r)):(n.value&&URL.revokeObjectURL(n.value),n.value=URL.createObjectURL(r))},D=(i,r)=>{O(r,i)};return Q([a,n,b],async([i,r])=>{if(l.value=null,!(!i||!r))try{const[u,s]=await Promise.all([y(i),y(r)]),v=Math.min(u.height,s.height),N=v/u.height,S=v/s.height,C=Math.round(u.width*N),I=Math.round(s.width*S),g=document.createElement("canvas");g.width=C+I,g.height=v;const U=g.getContext("2d");if(!U)return;if(U.drawImage(u,0,0,C,v),U.drawImage(s,C,0,I,v),b.value==="grayscale"){const M=U.getImageData(0,0,g.width,g.height),m=M.data;for(let d=0;d<m.length;d+=4){const B=m[d]??0,E=m[d+1]??0,$=m[d+2]??0,w=Math.round(.299*B+.587*E+.114*$);m[d]=w,m[d+1]=w,m[d+2]=w}U.putImageData(M,0,0)}l.value=g.toDataURL("image/png")}catch{l.value=null}}),T(()=>{a.value&&URL.revokeObjectURL(a.value),n.value&&URL.revokeObjectURL(n.value)}),{t:e,locale:t,leftUrl:a,rightUrl:n,leftFile:R,rightFile:k,combinedUrl:l,colorMode:b,handleFileUpload:D}}}),q={class:"input-row"},A={class:"input-group"},X={class:"input-group"},Y=["aria-label"],Z={value:"rgb"},_={value:"grayscale"},x={key:0,class:"preview-row"},ee={key:0,class:"preview"},oe=["src","alt"],le={key:1,class:"preview"},te=["src","alt"],ae={key:1,class:"combined"},ne=["src","alt"],ie=["href"],re={key:2,class:"hint"};function se(e,t,a,n,R,k){return f(),p("div",{id:"image-connector",key:e.locale},[o("h1",null,c(e.t("tools.imageConnector.title")),1),o("div",q,[o("div",A,[V(F,{modelValue:e.leftFile,"onUpdate:modelValue":[t[0]||(t[0]=l=>e.leftFile=l),t[1]||(t[1]=l=>e.handleFileUpload(l,"left"))],accept:"image/*",outlined:"",color:"primary",label:e.t("tools.imageConnector.uploadLeft"),"no-files-label":e.t("tools.imageConnector.noFile")},null,8,["modelValue","label","no-files-label"])]),o("div",X,[V(F,{modelValue:e.rightFile,"onUpdate:modelValue":[t[2]||(t[2]=l=>e.rightFile=l),t[3]||(t[3]=l=>e.handleFileUpload(l,"right"))],accept:"image/*",outlined:"",color:"primary",label:e.t("tools.imageConnector.uploadRight"),"no-files-label":e.t("tools.imageConnector.noFile")},null,8,["modelValue","label","no-files-label"])]),o("label",null,[z(c(e.t("tools.imageConnector.colorMode.label"))+" ",1),G(o("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>e.colorMode=l),"aria-label":e.t("tools.imageConnector.colorMode.label")},[o("option",Z,c(e.t("tools.imageConnector.colorMode.rgb")),1),o("option",_,c(e.t("tools.imageConnector.colorMode.grayscale")),1)],8,Y),[[H,e.colorMode]])])]),e.leftUrl||e.rightUrl?(f(),p("div",x,[e.leftUrl?(f(),p("div",ee,[o("h3",null,c(e.t("tools.imageConnector.left")),1),o("img",{src:e.leftUrl,alt:e.t("tools.imageConnector.left")},null,8,oe)])):L("",!0),e.rightUrl?(f(),p("div",le,[o("h3",null,c(e.t("tools.imageConnector.right")),1),o("img",{src:e.rightUrl,alt:e.t("tools.imageConnector.right")},null,8,te)])):L("",!0)])):L("",!0),e.combinedUrl?(f(),p("div",ae,[o("h3",null,c(e.t("tools.imageConnector.combined")),1),o("img",{src:e.combinedUrl,alt:e.t("tools.imageConnector.combined")},null,8,ne),o("a",{href:e.combinedUrl,download:"connected-image.png"},[o("button",null,c(e.t("tools.imageConnector.save")),1)],8,ie)])):(f(),p("p",re,c(e.t("tools.imageConnector.hint")),1))])}const be=W(K,[["render",se]]);export{be as default};
